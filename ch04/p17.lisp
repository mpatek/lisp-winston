; Define COMPILE-ARITHMETIC.
(DEFUN COMPILE-ARITHMETIC (L)
       (COMPILE-ARITHMETIC-AUX L 1))
(DEFUN COMPILE-ARITHMETIC-AUX (L REGISTER)
       (COND ((ATOM L) (LIST (LIST 'MOVE REGISTER L)))
             (T (APPEND (COMPILE-ARITHMETIC-AUX (CADR L) REGISTER)
                              (COMPILE-ARITHMETIC-AUX (CADDR L) (+ REGISTER 1))
                              (LIST (LIST (COMPILE-ARITHMETIC-OPER (CAR L)) REGISTER (+ REGISTER 1)))))))
(DEFUN COMPILE-ARITHMETIC-OPER (OP)
       (COND ((EQUAL '+ OP) 'ADD)
             ((EQUAL '- OP) 'SUB)
             ((EQUAL '* OP) 'MUL)
             ((EQUAL '/ OP) 'DIV)
             (T NIL)))
